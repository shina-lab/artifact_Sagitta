<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RCA Report: poppler PNG001</title>
    <style>
        a {
            color: #000;
            text-decoration: none;
        }

        code {
            font-family: 'Consolas';
            background-color: #f0f0f0;
           
            &:before, &:after {
                content: '`';
            }
        }

        img {
            max-width: 100%;
        }
    </style>
</head>
<body>
    <h1>RCA Report: libpng PNG001</h1>

    <details>
        <summary>Patch</summary>
        <pre>
--- a/pngrutil.c
+++ b/pngrutil.c
@@ -3163,12 +3163,27 @@ png_check_chunk_length(png_const_structrp png_ptr, png_uint_32 length)
    if (png_ptr->chunk_name == png_IDAT)
    {
       png_alloc_size_t idat_limit = PNG_UINT_31_MAX;
+#ifdef MAGMA_ENABLE_FIXES
       size_t row_factor =
          (size_t)png_ptr->width
          * (size_t)png_ptr->channels
          * (png_ptr->bit_depth > 8? 2: 1)
          + 1
          + (png_ptr->interlaced? 6: 0);
+#else
+      size_t row_factor_l =
+         (size_t)png_ptr->width
+         * (size_t)png_ptr->channels
+         * (png_ptr->bit_depth > 8? 2: 1)
+         + 1
+         + (png_ptr->interlaced? 6: 0);
+
+#ifdef MAGMA_ENABLE_CANARIES
+      MAGMA_LOG("%MAGMA_BUG%", row_factor_l == ((size_t)1 << (sizeof(png_uint_32) * 8)));
+#endif
+
+      size_t row_factor = (png_uint_32)row_factor_l;
+#endif
       if (png_ptr->height > PNG_UINT_32_MAX/row_factor)
          idat_limit = PNG_UINT_31_MAX;
       else
        </pre>
    </details>

    <h1>Canary-based / Crash-based</h1>
    <h2><code>row_factor_l</code></h2>
    <h3><a href=result/diff.subgraph.row_factor_l.000974.dot.svg>non-crash</a></h3>
    <img src="result/diff.subgraph.row_factor_l.000974.dot.svg">
    <h3><a href=result/diff.subgraph.row_factor_l.crash-000073.dot.svg>crash</a></h3>
    <img src="result/diff.subgraph.row_factor_l.crash-000073.dot.svg">
</body>
</html>